<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>kjentmannstest</title> 
</head>
<body>

<div id="googleMap" style="width:100%;height:700px;"></div>

<script>

//Kmtkode.txt inneholder kommentarer og funksjoner til koden

function myMap() {
  var mapProp= {
    center:new google.maps.LatLng(63.434138, 10.466901),
    zoom:15,
    mapTypeId: "satellite",
  };
var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

// 1
const way = []

//Test - Verdiene vi sammenligner
var fasit = 0;
var test = 0;

// 2
var drawingManager = new google.maps.drawing.DrawingManager({
  drawingMode: google.maps.drawing.OverlayType.POLYLINE,
  drawingControlOptions:{
    drawingModes: [google.maps.drawing.OverlayType.POLYLINE],
    position: google.maps.ControlPosition.RIGHT_CENTER,
  },
});
drawingManager.setMap(map);


// 3
google.maps.event.addListener(drawingManager, 'polylinecomplete', polygon =>{
  for (const point of polygon.getPath().getArray()){
    way.push({
      location: point.lat()+','+ point.lng(),
      stopover: false,
    });
  }
  a().then(res => test = response.routes[0].legs[0].duration.value)
  //console.log("a:"+fasit)
  b()
  //console.log("b:"+test)
  amotb(test,fasit)
});

// 5
const start = { lat: 63.426285, lng: 10.515368};
const slutt = { lat: 63.437168, lng: 10.421877 };

// 6
new google.maps.Marker({
  position: start,
  map,
});
new google.maps.Marker({
  position: slutt,
  map,
});

// 7
const directionsService = new google.maps.DirectionsService();

// 8
async function a(){
  directionsService.route({
    origin: start.lat + ', ' + start.lng,
    destination: slutt.lat + ', ' + slutt.lng,
    travelMode: 'DRIVING'
  },
  (response => {
    fasit = response.routes[0].legs[0].duration.value;
    console.log("a:"+fasit);
  }));
};
// 9
function b(){
  directionsService.route({
    origin: start.lat + ', ' + start.lng,
    destination: slutt.lat + ', ' + slutt.lng,
    travelMode: 'DRIVING',
    waypoints: way,
  },
  (response => { 
    test = response.routes[0].legs[0].duration.value;
    console.log("b:"+test); 
  }));
};


//10
function amotb(test,fasit){

  if (fasit > (test-200)){
    //window.location = "bestottside.html"
    console.log("Bestått");
    console.log("test: "+test);
    console.log("Fasit: "+fasit);
  }
  else {
    //window.location = "Ikkebestott.html"
    console.log("Ikke bestått");
    console.log("test: "+test);
    console.log("Fasit: "+fasit);
  };
};

};

//11
function tilbake(){
  window.location = "forside.html"
}
function startpånytt(){
  window.location = "Kjentmannstest.html"
}

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAoZDd5YpXm_qYw5Dxov44Cj83l7-SvUhk&libraries=drawing&callback=myMap"></script>

<!-- 12 -->
<button onclick="tilbake()">Tilbake</button>
<button onclick="startpånytt()">Start på nytt</button>

</body>
</html>

